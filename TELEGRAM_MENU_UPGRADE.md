# 텔레그램 메뉴 개선 완료

**작성일**: 2026-01-21  
**버전**: 2.0

---

## ✅ 완료 내용

### 1. 국내/해외 주식 분리 메뉴 구현
- **메인 메뉴**: 시스템 상태, 국내주식, 해외주식, 전체 잔고, 도움말
- **국내주식 메뉴**: 자동매매 on/off, 보유 종목, 잔고 조회
- **해외주식 메뉴**: 자동매매 on/off, 보유 종목 (USD), 잔고 조회 (USD)

### 2. 인라인 키보드 (버튼) 방식
- ✅ 명령어 입력 불필요
- ✅ 버튼 클릭만으로 모든 기능 사용
- ✅ 직관적인 UI/UX

### 3. 완전한 국내/해외 분리
- **국내주식**: 원화 단위, KOSPI/KOSDAQ
- **해외주식**: USD 단위, NASDAQ/NYSE/AMEX/홍콩 등

---

## 📱 메뉴 구조

```
🤖 메인 메뉴
├── 📊 시스템 상태
│   └── 국내/해외 자동매매 활성화 여부
│   └── 각 시장별 포지션 수
│   └── 매수금액 설정
│
├── 🇰🇷 국내주식
│   ├── ✅ 자동매매 시작
│   ├── ⏸️ 자동매매 중지
│   ├── 📊 보유 종목
│   └── 💰 잔고 조회
│
├── 🌎 해외주식
│   ├── ✅ 자동매매 시작
│   ├── ⏸️ 자동매매 중지
│   ├── 📊 보유 종목 (USD)
│   └── 💰 잔고 조회 (USD)
│
├── 💰 전체 잔고
│   ├── 국내주식 잔고 (원)
│   └── 해외주식 잔고 (USD)
│
└── ❓ 도움말
    └── 사용 방법 안내
```

---

## 🎮 사용 방법

### 1단계: 봇 시작
```
텔레그램에서 봇과 대화 시작
→ /start 명령 입력
```

### 2단계: 메뉴 선택
```
📱 인라인 키보드 (버튼) 방식
→ 버튼 클릭만으로 모든 기능 사용
```

### 3단계: 자동매매 시작
```
국내주식 메뉴 → ✅ 자동매매 시작
또는
해외주식 메뉴 → ✅ 자동매매 시작
```

---

## 🔍 주요 기능

### 📊 시스템 상태
```
📊 시스템 상태

🇰🇷 국내주식: ✅ 활성화
   포지션: 2개
   매수금액: 1,000,000원

🌎 해외주식: ❌ 비활성화
   포지션: 0개
   매수금액: $500

익절: 3.0%
손절: 2.5%
```

### 💰 전체 잔고
```
💰 전체 잔고

🇰🇷 국내주식
   예수금: 5,000,000원
   평가액: 6,200,000원

🌎 해외주식
   예수금: $2,500.00
   평가액: $2,750.00
```

### 📊 보유 종목 (국내)
```
📊 국내주식 보유 종목 (2개)

[005930] 삼성전자
  매수가: 75,000원
  현재가: 77,250원
  수익률: +3.00%
  수량: 13주
  상태: active

[000660] SK하이닉스
  매수가: 130,000원
  현재가: 128,700원
  수익률: -1.00%
  수량: 7주
  상태: active
```

### 📊 보유 종목 (해외)
```
📊 해외주식 보유 종목 (1개)

[AAPL] Apple Inc.
  매수가: $175.50
  현재가: $180.75
  수익률: +2.99%
  수량: 3주
  상태: active
```

---

## ⚙️ 설정 파일

### config.json
```json
{
  "telegram": {
    "bot_token": "8589662322:AAEeCIf0Poce5kmYD43zYwdYSp6MzTdwOOM",
    "chat_id": "5030462236"
  },
  "kis": {
    "server": "vps"
  },
  "trading": {
    "domestic": {
      "enabled": false,
      "buy_amount": 1000000,
      "profit_target": 0.03,
      "trailing_stop": 0.02,
      "stop_loss": 0.025,
      "check_interval": 5
    },
    "overseas": {
      "enabled": false,
      "buy_amount": 500,
      "profit_target": 0.03,
      "trailing_stop": 0.02,
      "stop_loss": 0.025,
      "check_interval": 5
    }
  },
  "webhook": {
    "enabled": true,
    "port": 8080,
    "secret_token": ""
  }
}
```

---

## 🚀 실행 방법

### 1. 설정 파일 준비
```bash
# config.json 생성
cp config.json.example config.json

# kis_devlp.yaml 생성 (KIS API 키 필요)
cp kis_devlp.yaml.example kis_devlp.yaml
# → 파일 편집하여 APP_KEY, APP_SECRET 입력
```

### 2. 봇 실행
```bash
python tradingview_bot.py
```

### 3. 텔레그램에서 테스트
```
1) /start 명령 입력
2) 📊 시스템 상태 확인
3) 🇰🇷 국내주식 → 💰 잔고 조회
4) 🌎 해외주식 → 💰 잔고 조회 (USD)
```

---

## 📋 다음 단계

### 우선순위 1: 잔고 조회 테스트
- ✅ 국내주식 잔고 조회 정상 여부 확인
- ✅ 해외주식 잔고 조회 정상 여부 확인
- ✅ kis_devlp.yaml 설정 검증

### 우선순위 2: 알림 테스트
- ✅ 트레이딩뷰 → 텔레그램 알림 수신 확인
- ✅ Webhook 수신 확인

### 우선순위 3: 매매 테스트
- ✅ 모의투자로 매수 주문 테스트
- ✅ 익절/손절 로직 검증
- ✅ 실전투자 전환 (신중하게)

---

## ⚠️ 주의사항

### 1. KIS API 설정 필수
```yaml
# kis_devlp.yaml 파일에 반드시 입력
appkey_vps: "모의투자_APP_KEY"
appsecret_vps: "모의투자_APP_SECRET"

# 실전투자는 신중하게
appkey_prod: "실전투자_APP_KEY"
appsecret_prod: "실전투자_APP_SECRET"
account_prod: "계좌번호"
```

### 2. 모의투자로 먼저 테스트
```json
// config.json
"kis": {
  "server": "vps"  // vps = 모의투자, prod = 실전투자
}
```

### 3. 텔레그램 봇 토큰 보안
- **절대 공개하지 마세요**
- GitHub에 업로드 금지
- .gitignore에 config.json 추가

---

## 📚 관련 문서

- **COMPLETE_SETUP_GUIDE.md**: 전체 설정 가이드
- **OVERSEAS_TRADING_GUIDE.md**: 해외주식 거래 가이드
- **FINAL_SUMMARY.md**: 프로젝트 최종 요약
- **TRADINGVIEW_TELEGRAM_DIRECT.md**: 트레이딩뷰 → 텔레그램 직접 연결

---

## 🎉 완료!

텔레그램 메뉴 개선이 완료되었습니다!

**다음 단계**: 
1. 봇 실행
2. 잔고 조회 테스트
3. 알림 수신 테스트
4. 모의 매매 테스트
